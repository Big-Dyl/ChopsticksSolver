(()=>{"use strict";class t{constructor(t,s){this.status=[[1,1],[1,1]],this.hashTable=new Map,this.doleftovers=!0,this.getBestMove=(t,s)=>{if(t){let t=this.getMoves(0),h=-1/0,a=0;for(let i=0;i<t.length;i++){let e=[[this.status[0][0],this.status[0][1]],[this.status[1][0],this.status[1][1]]];this.playMove(t[i]);let u=this.solveBoard(!1,s-1);this.status=[[e[0][0],e[0][1]],[e[1][0],e[1][1]]],u>h&&(h=u,a=t[i])}return a}{let t=this.getMoves(1),h=1/0,a=0;for(let i=0;i<t.length;i++){let e=[[this.status[0][0],this.status[0][1]],[this.status[1][0],this.status[1][1]]];this.playMove(t[i]);let u=this.solveBoard(!0,s-1);this.status=[[e[0][0],e[0][1]],[e[1][0],e[1][1]]],u<h&&(h=u,a=t[i])}return a}},this.solveBoard=(t,s)=>{if(this.hashTable.has(`${this.status[0][0]}${this.status[0][1]}${this.status[1][0]}${this.status[1][1]}${t?1:0}d${s}`))return this.hashTable.get(`${this.status[0][0]}${this.status[0][1]}${this.status[1][0]}${this.status[1][1]}${t?1:0}d${s}`);if(s<=0)return 0;if(0==this.status[0][0]&&0==this.status[0][1])return-s;if(0==this.status[1][0]&&0==this.status[1][1])return s;if(t){let h=this.getMoves(0),a=-1/0;for(let t=0;t<h.length;t++){let i=[[this.status[0][0],this.status[0][1]],[this.status[1][0],this.status[1][1]]];this.playMove(h[t]);let e=this.solveBoard(!1,s-1);this.status=[[i[0][0],i[0][1]],[i[1][0],i[1][1]]],e>a&&(a=e)}return this.hashTable.set(`${this.status[0][0]}${this.status[0][1]}${this.status[1][0]}${this.status[1][1]}${t?1:0}d${s}`,a),a}{let h=this.getMoves(1),a=1/0;for(let t=0;t<h.length;t++){let i=[[this.status[0][0],this.status[0][1]],[this.status[1][0],this.status[1][1]]];this.playMove(h[t]);let e=this.solveBoard(!0,s-1);this.status=[[i[0][0],i[0][1]],[i[1][0],i[1][1]]],e<a&&(a=e)}return this.hashTable.set(`${this.status[0][0]}${this.status[0][1]}${this.status[1][0]}${this.status[1][1]}${t?1:0}d${s}`,a),a}},this.playMove=t=>{let s=[(16&t)>>4,(8&t)>>3],h=[(4&t)>>2,(2&t)>>1],a=1&t,i=this.status[s[0]][s[1]],e=this.status[h[0]][h[1]];if(this.status[s[0]]==this.status[h[0]]){let t=[],u=i+e;for(let s=0;s<=u-s;s++)s!=Math.min(i,e)&&u-s<5&&t.push([u-s,s]);this.status[s[0]][s[1]]=t[a][1],this.status[h[0]][h[1]]=t[a][0]}else this.doleftovers?this.status[h[0]][h[1]]=e+i<=4?e+i:e+i-5:this.status[h[0]][h[1]]=e+i<=4?e+i:0},this.getMoves=t=>{let s=[];for(let i=0;i<2;i++)if(0!=this.status[t][i])for(let h=0;h<2;h++)0!=this.status[1^t][h]&&s.push(parseInt(`${t}${i}${1^t}${h}0`,2));let h=0,a=this.status[t][0]+this.status[t][1];for(let i=0;i<=a-i;i++)i!=Math.min(this.status[t][0],this.status[t][1])&&a-i<5&&h++;for(let i=0;i<h;i++){let h=parseInt(`${t}0${t}1${i}`,2);s.includes(h)||s.push(h)}return s},this.status=[[t[0],t[1]],[t[2],t[3]]],this.doleftovers=s}}onmessage=s=>{let h=new t(s.data[0],s.data[3]).solveBoard(s.data[1],s.data[2]);postMessage(h)}})();
//# sourceMappingURL=446.bc40a9f3.chunk.js.map